{% extends "stepping_out/__base.html" %}

{% load url from future %}

{% block main %}
    {% for dance in scheduled_dances %}
        <h3><a href="{% url 'stepping_out_scheduled_dance_detail' slug=dance.slug %}">{{ dance.name }}</a>{% if dance.venue %} <small>at <a href="{% url 'stepping_out_venue_detail' slug=dance.venue.slug %}">{{ dance.venue.name }}</a></small>{% endif %}</h3>
        <h4>
            {% with weeks=dance.get_weeks %}
                {% if weeks|length == 5 %}
                    Every {{ dance.get_weekday_display }}
                {% else %}
                    {% filter capfirst %}{% for week in weeks %}{% if forloop.last and not forloop.first %} and {% endif %}{{ week|lower }}{% if weeks|length > 2 and not forloop.last %}, {% endif %}{% endfor %}
                    {% endfilter %}
                    {{ dance.get_weekday_display }}{{ weeks|pluralize }}
                {% endif %}
            {% endwith %}
            {% if dance.start and dance.end %}
                from <time datetime="{{ dance.start|date:'H:i' }}">{{ dance.start|date:'g:i a' }}</time> to <time datetime="{{ dance.end|date:'H:i' }}">{{ dance.end|date:'g:i a' }}</time>
            {% endif %}
        </h4>
        {% if dance.venue %}
            {% include "stepping_out/_venue_map.html" with venue=dance.venue only %}
        {% endif %}
    {% endfor %}
{% endblock %}
